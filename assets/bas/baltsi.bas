'*****************************************************************************
SCREEN 12
'*****************************************************************************
RANDOMIZE TIMER
'*****************************************************************************
DIM energy AS INTEGER
'*****************************************************************************
ballgame:
energy = 50: x = 100
CONST r = 10, max = 10, a = 1, vr = 15, avy = -8.4
y = 26 + r
b = .1
x1 = x: y1 = y
'*****************************************************************************
LINE (0, 0)-(635, 440), 7, B
LINE (5, 5)-(630, 435), 7, B
PAINT (3, 3), 7
LINE (5, 405)-(630, 410), 7, BF
'*****************************************************************************
LINE (6, 405)-(116, 407), 4, BF
LINE (629, 405)-(529, 407), 4, BF
LINE (256, 405)-(379, 407), 11, BF
'*****************************************************************************
LOCATE 27, 2: PRINT "POINTS:"
LOCATE 27, 20: PRINT "ENERGY:"
'*****************************************************************************
'*****************************************************************************
looppi:
IF w = 0 THEN
    w = 1
    q = INT(RND(1) * 580) + 35
    e = INT(RND(1) * 340) + 35
    CIRCLE (q, e), r, 14
    PAINT (q, e), 14
END IF
'*****************************************************************************
vy = vy - b
y = y - vy
x = x + vx
'*****************************************************************************
IF x > 619 OR x < 16 THEN x = x1: vx = -vx: GOSUB ener
IF ABS(q - x) < 20 AND ABS(e - y) < 20 THEN
    w = 0
    points = points + 100
    LOCATE 27, 10: PRINT points
    PAINT (q, e), 0
    SOUND 440, .44
END IF
'*****************************************************************************
IF vy < avy THEN
    b = .2
    IF x < 116 THEN b = .1
    IF x > 529 THEN b = .1
    IF x > 256 AND x < 379 THEN b = .4
    vy = -avy + b
    y = 405 - r - 1
    GOSUB ener
END IF
'*****************************************************************************
CIRCLE (x, y), r, vr
CIRCLE (x1, y1), r, 0
'*****************************************************************************
x1 = x: y1 = y
'*****************************************************************************
g$ = INKEY$
SELECT CASE g$
    CASE ""
        GOTO looppi
    CASE "4"
        IF vx > -a * max THEN vx = vx - a
    CASE "5"
        w = 0
        points = points - 100
        LOCATE 27, 10: PRINT points
        PAINT (q, e), 0
        SOUND 250, 250 / 1000
    CASE "6"
        IF vx < a * max THEN vx = vx + a
    CASE CHR$(27)
        END
END SELECT
'*****************************************************************************
GOTO looppi
'*****************************************************************************
'*****************************************************************************
ener:
energy = energy - 1
LOCATE 27, 28: PRINT energy
IF energy = 0 THEN CIRCLE (x1, y1), r, 0: CIRCLE (x, y), r, vr: GOTO loppu
RETURN
'*****************************************************************************
loppu:
END
'*****************************************************************************